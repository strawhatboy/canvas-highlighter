// canvas-highlighter Version 1.0.0. Copyright 2017 undefined.
(function(t){"use strict";function e(){}function n(){n.init.call(this)}function r(t){return void 0===t._maxListeners?n.defaultMaxListeners:t._maxListeners}function i(t,e,n){if(e)t.call(n);else for(var r=t.length,i=d(t,r),o=0;o<r;++o)i[o].call(n)}function o(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,o=d(t,i),s=0;s<i;++s)o[s].call(n,r)}function s(t,e,n,r,i){if(e)t.call(n,r,i);else for(var o=t.length,s=d(t,o),a=0;a<o;++a)s[a].call(n,r,i)}function a(t,e,n,r,i,o){if(e)t.call(n,r,i,o);else for(var s=t.length,a=d(t,s),c=0;c<s;++c)a[c].call(n,r,i,o)}function c(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,o=d(t,i),s=0;s<i;++s)o[s].apply(n,r)}function u(t,n,i,o){var s,a,c;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if((a=t._events)?(a.newListener&&(t.emit("newListener",n,i.listener?i.listener:i),a=t._events),c=a[n]):(a=t._events=new e,t._eventsCount=0),c){if("function"==typeof c?c=a[n]=o?[i,c]:[c,i]:o?c.unshift(i):c.push(i),!c.warned&&(s=r(t))&&s>0&&c.length>s){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+n+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=n,u.count=c.length,h(u)}}else c=a[n]=i,++t._eventsCount;return t}function h(t){"function"==typeof console.warn?console.warn(t):console.log(t)}function l(t,e,n){function r(){t.removeListener(e,r),i||(i=!0,n.apply(t,arguments))}var i=!1;return r.listener=n,r}function f(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function p(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}function d(t,e){for(var n=new Array(e);e--;)n[e]=t[e];return n}function v(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function y(t,e){return t===e||t!==t&&e!==e}function _(t,e){for(var n=t.length;n--;)if(y(t[n][0],e))return n;return-1}function g(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function b(t){var e=dt.call(t,yt),n=t[yt];try{t[yt]=void 0;var r=!0}catch(t){}var i=vt.call(t);return r&&(e?t[yt]=n:delete t[yt]),i}function m(t){return _t.call(t)}function E(t){return null==t?void 0===t?bt:gt:mt&&mt in Object(t)?b(t):m(t)}function j(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function w(t){if(!j(t))return!1;var e=E(t);return e==jt||e==wt||e==Et||e==Ct}function C(t){return!!Rt&&Rt in t}function O(t){if(null!=t){try{return Tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function R(t){return!(!j(t)||C(t))&&(w(t)?Dt:At).test(O(t))}function T(t,e){return null==t?void 0:t[e]}function S(t,e){var n=T(t,e);return R(n)?n:void 0}function A(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function L(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function k(t,e){var n=t.__data__;return L(e)?n["string"==typeof e?"string":"hash"]:n.map}function M(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function x(t){var e=this.__data__=new g(t);this.size=e.size}function D(t,e,n){"__proto__"==e&&Ft?Ft(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function z(t,e,n){var r=t[e];qt.call(t,e)&&y(r,n)&&(void 0!==n||e in t)||D(t,e,n)}function P(t,e,n,r){var i=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var a=e[o],c=r?r(n[a],t[a],a,n,t):void 0;void 0===c&&(c=t[a]),i?D(n,a,c):z(n,a,c)}return n}function I(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function N(t){return null!=t&&"object"==typeof t}function B(t){return N(t)&&E(t)==Wt}function V(t,e){return!!(e=null==e?Xt:e)&&("number"==typeof t||te.test(t))&&t>-1&&t%1==0&&t<e}function U(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ee}function F(t,e){var n=at(t),r=!n&&Zt(t),i=!n&&!r&&Qt(t),o=!n&&!r&&!i&&ce(t),s=n||r||i||o,a=s?I(t.length,String):[],c=a.length;for(var u in t)!e&&!ue.call(t,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||V(u,c))||a.push(u);return a}function q(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||he)}function W(t){if(!q(t))return le(t);var e=[];for(var n in Object(t))fe.call(t,n)&&"constructor"!=n&&e.push(n);return e}function $(t){return null!=t&&U(t.length)&&!w(t)}function H(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}function K(t){if(!j(t))return H(t);var e=q(t),n=[];for(var r in t)("constructor"!=r||!e&&pe.call(t,r))&&n.push(r);return n}function Z(t){return $(t)?F(t,!0):K(t)}function Y(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new M;++e<n;)this.add(t[e])}function G(t){return"string"==typeof t||!at(t)&&N(t)&&E(t)==Re}function J(t){return t}function Q(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function X(t,e,n){return e=ke(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=ke(r.length-e,0),s=Array(o);++i<o;)s[i]=r[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=r[i];return a[e]=n(s),Q(t,this,a)}}function tt(t){return function(){return t}}function et(t,e){return Pe(X(t,e,J),t+"")}function nt(t,e,n){if(!j(n))return!1;var r=typeof e;return!!("number"==r?$(n)&&V(e,n.length):"string"==r&&e in n)&&y(n[e],t)}function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function it(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function ot(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var st={ClassNames:{MASK:"canvas-highlighter-mask",RECT:"canvas-highlighter-rect",RECT_STAND_BY:"canvas-highlighter-rect-stand-by",RECT_ACTIVED:"canvas-highlighter-rect-actived",RECT_SELECTED:"canvas-highlighter-rect-selected"},Events:{RECT_ACTIVED:"RECT_ACTIVED",RECT_DISACTIVED:"RECT_DISACTIVED",RECT_SELECTED:"RECT_SELECTED",RECT_UNSELECTED:"RECT_UNSELECTED"},Strings:{ID:"uuid"}};e.prototype=Object.create(null),n.EventEmitter=n,n.usingDomains=!1,n.prototype.domain=void 0,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.init=function(){this.domain=null,n.usingDomains&&(!(void 0).active||this instanceof(void 0).Domain||(this.domain=(void 0).active)),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new e,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},n.prototype.getMaxListeners=function(){return r(this)},n.prototype.emit=function(t){var e,n,r,u,h,l,f,p="error"===t;if(l=this._events)p=p&&null==l.error;else if(!p)return!1;if(f=this.domain,p){if(e=arguments[1],!f){if(e instanceof Error)throw e;var d=new Error('Uncaught, unspecified "error" event. ('+e+")");throw d.context=e,d}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=f,e.domainThrown=!1,f.emit("error",e),!1}if(!(n=l[t]))return!1;var v="function"==typeof n;switch(r=arguments.length){case 1:i(n,v,this);break;case 2:o(n,v,this,arguments[1]);break;case 3:s(n,v,this,arguments[1],arguments[2]);break;case 4:a(n,v,this,arguments[1],arguments[2],arguments[3]);break;default:for(u=new Array(r-1),h=1;h<r;h++)u[h-1]=arguments[h];c(n,v,this,u)}return!0},n.prototype.addListener=function(t,e){return u(this,t,e,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(t,e){return u(this,t,e,!0)},n.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,l(this,t,e)),this},n.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,l(this,t,e)),this},n.prototype.removeListener=function(t,n){var r,i,o,s,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(r=i[t]))return this;if(r===n||r.listener&&r.listener===n)0==--this._eventsCount?this._events=new e:(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if("function"!=typeof r){for(o=-1,s=r.length;s-- >0;)if(r[s]===n||r[s].listener&&r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new e,this;delete i[t]}else p(r,o);i.removeListener&&this.emit("removeListener",t,a||n)}return this},n.prototype.removeAllListeners=function(t){var n,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new e,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new e:delete r[t]),this;if(0===arguments.length){for(var i,o=Object.keys(r),s=0;s<o.length;++s)"removeListener"!==(i=o[s])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new e,this._eventsCount=0,this}if("function"==typeof(n=r[t]))this.removeListener(t,n);else if(n)do{this.removeListener(t,n[n.length-1])}while(n[0]);return this},n.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:v(e):[]},n.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},n.prototype.listenerCount=f,n.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var at=Array.isArray,ct=Array.prototype.splice;g.prototype.clear=function(){this.__data__=[],this.size=0},g.prototype.delete=function(t){var e=this.__data__,n=_(e,t);return!(n<0||(n==e.length-1?e.pop():ct.call(e,n,1),--this.size,0))},g.prototype.get=function(t){var e=this.__data__,n=_(e,t);return n<0?void 0:e[n][1]},g.prototype.has=function(t){return _(this.__data__,t)>-1},g.prototype.set=function(t,e){var n=this.__data__,r=_(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};var ut="object"==typeof global&&global&&global.Object===Object&&global,ht="object"==typeof self&&self&&self.Object===Object&&self,lt=ut||ht||Function("return this")(),ft=lt.Symbol,pt=Object.prototype,dt=pt.hasOwnProperty,vt=pt.toString,yt=ft?ft.toStringTag:void 0,_t=Object.prototype.toString,gt="[object Null]",bt="[object Undefined]",mt=ft?ft.toStringTag:void 0,Et="[object AsyncFunction]",jt="[object Function]",wt="[object GeneratorFunction]",Ct="[object Proxy]",Ot=lt["__core-js_shared__"],Rt=function(){var t=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Tt=Function.prototype.toString,St=/[\\^$.*+?()[\]{}|]/g,At=/^\[object .+?Constructor\]$/,Lt=Function.prototype,kt=Object.prototype,Mt=Lt.toString,xt=kt.hasOwnProperty,Dt=RegExp("^"+Mt.call(xt).replace(St,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zt=S(lt,"Map"),Pt=S(Object,"create"),It="__lodash_hash_undefined__",Nt=Object.prototype.hasOwnProperty,Bt=Object.prototype.hasOwnProperty,Vt="__lodash_hash_undefined__";A.prototype.clear=function(){this.__data__=Pt?Pt(null):{},this.size=0},A.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},A.prototype.get=function(t){var e=this.__data__;if(Pt){var n=e[t];return n===It?void 0:n}return Nt.call(e,t)?e[t]:void 0},A.prototype.has=function(t){var e=this.__data__;return Pt?void 0!==e[t]:Bt.call(e,t)},A.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Pt&&void 0===e?Vt:e,this},M.prototype.clear=function(){this.size=0,this.__data__={hash:new A,map:new(zt||g),string:new A}},M.prototype.delete=function(t){var e=k(this,t).delete(t);return this.size-=e?1:0,e},M.prototype.get=function(t){return k(this,t).get(t)},M.prototype.has=function(t){return k(this,t).has(t)},M.prototype.set=function(t,e){var n=k(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};var Ut=200;x.prototype.clear=function(){this.__data__=new g,this.size=0},x.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},x.prototype.get=function(t){return this.__data__.get(t)},x.prototype.has=function(t){return this.__data__.has(t)},x.prototype.set=function(t,e){var n=this.__data__;if(n instanceof g){var r=n.__data__;if(!zt||r.length<Ut-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new M(r)}return n.set(t,e),this.size=n.size,this};var Ft=function(){try{var t=S(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),qt=Object.prototype.hasOwnProperty,Wt="[object Arguments]",$t=Object.prototype,Ht=$t.hasOwnProperty,Kt=$t.propertyIsEnumerable,Zt=B(function(){return arguments}())?B:function(t){return N(t)&&Ht.call(t,"callee")&&!Kt.call(t,"callee")},Yt="object"==typeof t&&t&&!t.nodeType&&t,Gt=Yt&&"object"==typeof module&&module&&!module.nodeType&&module,Jt=Gt&&Gt.exports===Yt?lt.Buffer:void 0,Qt=(Jt?Jt.isBuffer:void 0)||function(){return!1},Xt=9007199254740991,te=/^(?:0|[1-9]\d*)$/,ee=9007199254740991,ne={};ne["[object Float32Array]"]=ne["[object Float64Array]"]=ne["[object Int8Array]"]=ne["[object Int16Array]"]=ne["[object Int32Array]"]=ne["[object Uint8Array]"]=ne["[object Uint8ClampedArray]"]=ne["[object Uint16Array]"]=ne["[object Uint32Array]"]=!0,ne["[object Arguments]"]=ne["[object Array]"]=ne["[object ArrayBuffer]"]=ne["[object Boolean]"]=ne["[object DataView]"]=ne["[object Date]"]=ne["[object Error]"]=ne["[object Function]"]=ne["[object Map]"]=ne["[object Number]"]=ne["[object Object]"]=ne["[object RegExp]"]=ne["[object Set]"]=ne["[object String]"]=ne["[object WeakMap]"]=!1;var re="object"==typeof t&&t&&!t.nodeType&&t,ie=re&&"object"==typeof module&&module&&!module.nodeType&&module,oe=ie&&ie.exports===re&&ut.process,se=function(){try{return oe&&oe.binding&&oe.binding("util")}catch(t){}}(),ae=se&&se.isTypedArray,ce=ae?function(t){return function(e){return t(e)}}(ae):function(t){return N(t)&&U(t.length)&&!!ne[E(t)]},ue=Object.prototype.hasOwnProperty,he=Object.prototype,le=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),fe=Object.prototype.hasOwnProperty,pe=Object.prototype.hasOwnProperty,de=(Object.prototype.propertyIsEnumerable,Object.getOwnPropertySymbols,S(lt,"DataView")),ve=S(lt,"Promise"),ye=S(lt,"Set"),_e=S(lt,"WeakMap"),ge=O(de),be=O(zt),me=O(ve),Ee=O(ye),je=O(_e),we=E;(de&&"[object DataView]"!=we(new de(new ArrayBuffer(1)))||zt&&"[object Map]"!=we(new zt)||ve&&"[object Promise]"!=we(ve.resolve())||ye&&"[object Set]"!=we(new ye)||_e&&"[object WeakMap]"!=we(new _e))&&(we=function(t){var e=E(t),n="[object Object]"==e?t.constructor:void 0,r=n?O(n):"";if(r)switch(r){case ge:return"[object DataView]";case be:return"[object Map]";case me:return"[object Promise]";case Ee:return"[object Set]";case je:return"[object WeakMap]"}return e});Function.prototype.toString.call(Object);var Ce="__lodash_hash_undefined__";Y.prototype.add=Y.prototype.push=function(t){return this.__data__.set(t,Ce),this},Y.prototype.has=function(t){return this.__data__.has(t)};var Oe=ft?ft.prototype:void 0,Re=(Oe&&Oe.valueOf,Object.prototype.hasOwnProperty,Object.prototype.hasOwnProperty,"[object String]"),Te="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Se="(?:\\ud83c[\\udde6-\\uddff]){2}",Ae="[\\ud800-\\udbff][\\udc00-\\udfff]",Le="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",ke=(["[^\\ud800-\\udfff]",Se,Ae].join("|"),["[^\\ud800-\\udfff]"+Te+"?",Te,Se,Ae,"[\\ud800-\\udfff]"].join("|"),Math.max),Me=Ft?function(t,e){return Ft(t,"toString",{configurable:!0,enumerable:!1,value:tt(e),writable:!0})}:J,xe=800,De=16,ze=Date.now,Pe=function(t){var e=0,n=0;return function(){var r=ze(),i=De-(r-n);if(n=r,i>0){if(++e>=xe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Me),Ie=function(t){return et(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,s&&nt(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var a=n[r];a&&t(e,a,r,o)}return e})}(function(t,e){P(e,Z(e),t)}),Ne=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Be=function(t){function e(t){rt(this,e);var n=it(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t&&(n.sourceElementSelector=t.sourceElement,n.targetElementSelector=t.targetElement,n.data=t.data,n.standByClass=t.standByClass||st.ClassNames.RECT_STAND_BY,n.activedClass=t.activedClass||st.ClassNames.RECT_ACTIVED,n.selectedClass=t.selectedClass||st.ClassNames.RECT_SELECTED,n.frameSize=t.frameSize,n.startingZIndex=t.startingZIndex||2e3,n.idPropertyName=t.idPropertyName||st.Strings.ID),n._init(),n}return ot(e,n),Ne(e,[{key:"render",value:function(){this._createMaskLayer(),this._renderRects(this.data)}},{key:"reRender",value:function(){this.clean(),this._init(),this.render()}},{key:"clean",value:function(){for(var t=0;t<this.rects.length;t++)this.rects[t].remove();this.rects=[],this.mask.remove(),this.mask=void 0,this.q=[]}},{key:"_renderRects",value:function(t){if(at(t))for(var e=0;e<t.length;e++)this.q.push(t[e]);else j(t)&&this.q.push(t);for(;this.q.length>0;){var n=this.q.shift();if(this._createRectOnMaskLayer({rect:n,layerSize:this,frameSize:this.frameSize}),n.children)for(var r=0;r<n.children.length;r++)this.q.push(n.children[r])}}},{key:"_createMaskLayer",value:function(){var t=document.createElement("div");t.setAttribute("style","width:100%;height:100%;left:0;right:0;top:0;bottom:0;position:absolute"),t.setAttribute("class",st.ClassNames.MASK),this.container.appendChild(t),this.mask=t,this.layerSize=this.layerSize||{width:this.mask.offsetWidth,height:this.mask.offsetHeight}}},{key:"_init",value:function(){this.sourceElement=document.querySelector(this.sourceElementSelector),this.targetElement=document.querySelector(this.targetElementSelector),this.targetElement?this.container=this.targetElement:this.container=this.sourceElement.parentElement,this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.rects=[],this.selectedRect={},this.selectedRealRect={},this.q=[],this.rectsMap={}}},{key:"_createRectOnMaskLayer",value:function(t){var e=this,n=void 0,r=void 0,i=void 0;t&&(n=t.rect||{left:0,top:0,right:0,bottom:0},r=t.layerSize||{width:100,height:100},i=t.frameSize||{width:100,height:100});var o=n;(o=Ie({},n)).left=void 0==n.left?void 0:n.left*r.width/i.width,o.right=void 0==n.right?void 0:n.right*r.width/i.width,o.top=void 0==n.top?void 0:n.top*r.height/i.height,o.bottom=void 0==n.bottom?void 0:n.bottom*r.height/i.height,o.width=void 0==n.width?void 0:n.width*r.width/i.width,o.height=void 0==n.height?void 0:n.height*r.height/i.height;var s=document.createElement("div"),a="position:absolute;";void 0!=o.left&&(a+="left:"+o.left+"px;"),void 0!=o.right&&(a+="right:"+o.right+"px;"),void 0!=o.top&&(a+="top:"+o.top+"px;"),void 0!=o.bottom&&(a+="bottom:"+o.bottom+"px;"),void 0!=o.width&&(a+="width:"+o.width+"px;"),void 0!=o.height&&(a+="height:"+o.height+"px;"),a+="box-sizing: border-box;z-index: "+this.startingZIndex++,s.setAttribute("style",a),s.setAttribute("class",this.standByClass),s.addEventListener("mouseover",function(){e._highlight(s,o)}),s.addEventListener("mouseout",function(){e._unhighlight(s,o)}),s.addEventListener("click",function(){e.selectedRect==s?e._unselect(e.selectedRect,e.selectedRealRect):(e._unselect(e.selectedRect,e.selectedRealRect),e._select(s,o))}),this.container.appendChild(s),this.rects.push(s);var c=o[this.idPropertyName];G(c)&&(this.rectsMap[c]={el:s,data:o})}},{key:"select",value:function(t,e){G(t)&&j(this.rectsMap[t])&&this._select(this.rectsMap[t].el,this.rectsMap[t].data,e)}},{key:"unselect",value:function(t,e){G(t)&&j(this.rectsMap[t])&&this._unselect(this.rectsMap[t].el,this.rectsMap[t].data,e)}},{key:"_select",value:function(t,e,n){this.selectedRect!=t&&(this.selectedRect=t,this.selectedRealRect=e,t.setAttribute("class",this.selectedClass),n||this.emit(st.Events.RECT_SELECTED,e))}},{key:"_unselect",value:function(t,e,n){this.selectedRect==t&&w(this.selectedRect.setAttribute)&&(this.selectedRect.setAttribute("class",this.standByClass),n||this.emit(st.Events.RECT_UNSELECTED,this.selectedRealRect),this.selectedRealRect={},this.selectedRect={})}},{key:"highlight",value:function(t,e){G(t)&&j(this.rectsMap[t])&&this._highlight(this.rectsMap[t].el,this.rectsMap[t].data,e)}},{key:"unhighlight",value:function(t,e){G(t)&&j(this.rectsMap[t])&&this._unhighlight(this.rectsMap[t].el,this.rectsMap[t].data,e)}},{key:"_highlight",value:function(t,e,n){this.selectedRect!=t&&t.setAttribute("class",this.activedClass),n||this.emit(st.Events.RECT_ACTIVED,e)}},{key:"_unhighlight",value:function(t,e,n){this.selectedRect!=t&&t.setAttribute("class",this.standByClass),n||this.emit(st.Events.RECT_DISACTIVED,e)}}]),e}();t.CanvasHighlighter=Be})(this["canvas-highlighter"]=this["canvas-highlighter"]||{});