// canvas-highlighter Version 1.0.0. Copyright 2017 undefined.
(function(t){"use strict";function e(){}function r(){r.init.call(this)}function n(t){return void 0===t._maxListeners?r.defaultMaxListeners:t._maxListeners}function i(t,e,r){if(e)t.call(r);else for(var n=t.length,i=d(t,n),o=0;o<n;++o)i[o].call(r)}function o(t,e,r,n){if(e)t.call(r,n);else for(var i=t.length,o=d(t,i),s=0;s<i;++s)o[s].call(r,n)}function s(t,e,r,n,i){if(e)t.call(r,n,i);else for(var o=t.length,s=d(t,o),a=0;a<o;++a)s[a].call(r,n,i)}function a(t,e,r,n,i,o){if(e)t.call(r,n,i,o);else for(var s=t.length,a=d(t,s),c=0;c<s;++c)a[c].call(r,n,i,o)}function c(t,e,r,n){if(e)t.apply(r,n);else for(var i=t.length,o=d(t,i),s=0;s<i;++s)o[s].apply(r,n)}function u(t,r,i,o){var s,a,c;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if((a=t._events)?(a.newListener&&(t.emit("newListener",r,i.listener?i.listener:i),a=t._events),c=a[r]):(a=t._events=new e,t._eventsCount=0),c){if("function"==typeof c?c=a[r]=o?[i,c]:[c,i]:o?c.unshift(i):c.push(i),!c.warned&&(s=n(t))&&s>0&&c.length>s){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+r+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=r,u.count=c.length,h(u)}}else c=a[r]=i,++t._eventsCount;return t}function h(t){"function"==typeof console.warn?console.warn(t):console.log(t)}function l(t,e,r){function n(){t.removeListener(e,n),i||(i=!0,r.apply(t,arguments))}var i=!1;return n.listener=r,n}function f(t){var e=this._events;if(e){var r=e[t];if("function"==typeof r)return 1;if(r)return r.length}return 0}function p(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}function d(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}function v(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function y(t,e){return t===e||t!==t&&e!==e}function _(t,e){for(var r=t.length;r--;)if(y(t[r][0],e))return r;return-1}function g(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function b(t){var e=dt.call(t,yt),r=t[yt];try{t[yt]=void 0;var n=!0}catch(t){}var i=vt.call(t);return n&&(e?t[yt]=r:delete t[yt]),i}function m(t){return _t.call(t)}function E(t){return null==t?void 0===t?bt:gt:mt&&mt in Object(t)?b(t):m(t)}function j(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function w(t){if(!j(t))return!1;var e=E(t);return e==jt||e==wt||e==Et||e==Ct}function C(t){return!!Rt&&Rt in t}function O(t){if(null!=t){try{return Tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function R(t){return!(!j(t)||C(t))&&(w(t)?xt:Lt).test(O(t))}function T(t,e){return null==t?void 0:t[e]}function A(t,e){var r=T(t,e);return R(r)?r:void 0}function L(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function S(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function k(t,e){var r=t.__data__;return S(e)?r["string"==typeof e?"string":"hash"]:r.map}function P(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function M(t){var e=this.__data__=new g(t);this.size=e.size}function x(t,e,r){"__proto__"==e&&Ft?Ft(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function D(t,e,r){var n=t[e];qt.call(t,e)&&y(n,r)&&(void 0!==r||e in t)||x(t,e,r)}function z(t,e,r,n){var i=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var a=e[o],c=n?n(r[a],t[a],a,r,t):void 0;void 0===c&&(c=t[a]),i?x(r,a,c):D(r,a,c)}return r}function N(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function I(t){return null!=t&&"object"==typeof t}function B(t){return I(t)&&E(t)==Wt}function V(t,e){return!!(e=null==e?Xt:e)&&("number"==typeof t||te.test(t))&&t>-1&&t%1==0&&t<e}function U(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ee}function F(t,e){var r=at(t),n=!r&&Zt(t),i=!r&&!n&&Qt(t),o=!r&&!n&&!i&&ce(t),s=r||n||i||o,a=s?N(t.length,String):[],c=a.length;for(var u in t)!e&&!ue.call(t,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||V(u,c))||a.push(u);return a}function q(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||he)}function W(t){if(!q(t))return le(t);var e=[];for(var r in Object(t))fe.call(t,r)&&"constructor"!=r&&e.push(r);return e}function $(t){return null!=t&&U(t.length)&&!w(t)}function H(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}function K(t){if(!j(t))return H(t);var e=q(t),r=[];for(var n in t)("constructor"!=n||!e&&pe.call(t,n))&&r.push(n);return r}function Z(t){return $(t)?F(t,!0):K(t)}function Y(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new P;++e<r;)this.add(t[e])}function G(t){return"string"==typeof t||!at(t)&&I(t)&&E(t)==Re}function J(t){return t}function Q(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function X(t,e,r){return e=ke(void 0===e?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=ke(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(s),Q(t,this,a)}}function tt(t){return function(){return t}}function et(t,e){return ze(X(t,e,J),t+"")}function rt(t,e,r){if(!j(r))return!1;var n=typeof e;return!!("number"==n?$(r)&&V(e,r.length):"string"==n&&e in r)&&y(r[e],t)}function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function it(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function ot(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var st={ClassNames:{MASK:"canvas-highlighter-mask",RECT:"canvas-highlighter-rect",RECT_STAND_BY:"canvas-highlighter-rect-stand-by",RECT_ACTIVED:"canvas-highlighter-rect-actived",RECT_SELECTED:"canvas-highlighter-rect-selected"},Events:{RECT_ACTIVED:"RECT_ACTIVED",RECT_DISACTIVED:"RECT_DISACTIVED",RECT_SELECTED:"RECT_SELECTED",RECT_UNSELECTED:"RECT_UNSELECTED"},PropertyNames:{ID:"uuid",childrenPropertyName:"children"}};e.prototype=Object.create(null),r.EventEmitter=r,r.usingDomains=!1,r.prototype.domain=void 0,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.init=function(){this.domain=null,r.usingDomains&&(!(void 0).active||this instanceof(void 0).Domain||(this.domain=(void 0).active)),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new e,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},r.prototype.getMaxListeners=function(){return n(this)},r.prototype.emit=function(t){var e,r,n,u,h,l,f,p="error"===t;if(l=this._events)p=p&&null==l.error;else if(!p)return!1;if(f=this.domain,p){if(e=arguments[1],!f){if(e instanceof Error)throw e;var d=new Error('Uncaught, unspecified "error" event. ('+e+")");throw d.context=e,d}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=f,e.domainThrown=!1,f.emit("error",e),!1}if(!(r=l[t]))return!1;var v="function"==typeof r;switch(n=arguments.length){case 1:i(r,v,this);break;case 2:o(r,v,this,arguments[1]);break;case 3:s(r,v,this,arguments[1],arguments[2]);break;case 4:a(r,v,this,arguments[1],arguments[2],arguments[3]);break;default:for(u=new Array(n-1),h=1;h<n;h++)u[h-1]=arguments[h];c(r,v,this,u)}return!0},r.prototype.addListener=function(t,e){return u(this,t,e,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(t,e){return u(this,t,e,!0)},r.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,l(this,t,e)),this},r.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,l(this,t,e)),this},r.prototype.removeListener=function(t,r){var n,i,o,s,a;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[t]))return this;if(n===r||n.listener&&n.listener===r)0==--this._eventsCount?this._events=new e:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if("function"!=typeof n){for(o=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){a=n[s].listener,o=s;break}if(o<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new e,this;delete i[t]}else p(n,o);i.removeListener&&this.emit("removeListener",t,a||r)}return this},r.prototype.removeAllListeners=function(t){var r,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new e,this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=new e:delete n[t]),this;if(0===arguments.length){for(var i,o=Object.keys(n),s=0;s<o.length;++s)"removeListener"!==(i=o[s])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new e,this._eventsCount=0,this}if("function"==typeof(r=n[t]))this.removeListener(t,r);else if(r)do{this.removeListener(t,r[r.length-1])}while(r[0]);return this},r.prototype.listeners=function(t){var e,r=this._events;return r&&(e=r[t])?"function"==typeof e?[e.listener||e]:v(e):[]},r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},r.prototype.listenerCount=f,r.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var at=Array.isArray,ct=Array.prototype.splice;g.prototype.clear=function(){this.__data__=[],this.size=0},g.prototype.delete=function(t){var e=this.__data__,r=_(e,t);return!(r<0||(r==e.length-1?e.pop():ct.call(e,r,1),--this.size,0))},g.prototype.get=function(t){var e=this.__data__,r=_(e,t);return r<0?void 0:e[r][1]},g.prototype.has=function(t){return _(this.__data__,t)>-1},g.prototype.set=function(t,e){var r=this.__data__,n=_(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var ut="object"==typeof global&&global&&global.Object===Object&&global,ht="object"==typeof self&&self&&self.Object===Object&&self,lt=ut||ht||Function("return this")(),ft=lt.Symbol,pt=Object.prototype,dt=pt.hasOwnProperty,vt=pt.toString,yt=ft?ft.toStringTag:void 0,_t=Object.prototype.toString,gt="[object Null]",bt="[object Undefined]",mt=ft?ft.toStringTag:void 0,Et="[object AsyncFunction]",jt="[object Function]",wt="[object GeneratorFunction]",Ct="[object Proxy]",Ot=lt["__core-js_shared__"],Rt=function(){var t=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Tt=Function.prototype.toString,At=/[\\^$.*+?()[\]{}|]/g,Lt=/^\[object .+?Constructor\]$/,St=Function.prototype,kt=Object.prototype,Pt=St.toString,Mt=kt.hasOwnProperty,xt=RegExp("^"+Pt.call(Mt).replace(At,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Dt=A(lt,"Map"),zt=A(Object,"create"),Nt="__lodash_hash_undefined__",It=Object.prototype.hasOwnProperty,Bt=Object.prototype.hasOwnProperty,Vt="__lodash_hash_undefined__";L.prototype.clear=function(){this.__data__=zt?zt(null):{},this.size=0},L.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},L.prototype.get=function(t){var e=this.__data__;if(zt){var r=e[t];return r===Nt?void 0:r}return It.call(e,t)?e[t]:void 0},L.prototype.has=function(t){var e=this.__data__;return zt?void 0!==e[t]:Bt.call(e,t)},L.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=zt&&void 0===e?Vt:e,this},P.prototype.clear=function(){this.size=0,this.__data__={hash:new L,map:new(Dt||g),string:new L}},P.prototype.delete=function(t){var e=k(this,t).delete(t);return this.size-=e?1:0,e},P.prototype.get=function(t){return k(this,t).get(t)},P.prototype.has=function(t){return k(this,t).has(t)},P.prototype.set=function(t,e){var r=k(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var Ut=200;M.prototype.clear=function(){this.__data__=new g,this.size=0},M.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},M.prototype.get=function(t){return this.__data__.get(t)},M.prototype.has=function(t){return this.__data__.has(t)},M.prototype.set=function(t,e){var r=this.__data__;if(r instanceof g){var n=r.__data__;if(!Dt||n.length<Ut-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new P(n)}return r.set(t,e),this.size=r.size,this};var Ft=function(){try{var t=A(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),qt=Object.prototype.hasOwnProperty,Wt="[object Arguments]",$t=Object.prototype,Ht=$t.hasOwnProperty,Kt=$t.propertyIsEnumerable,Zt=B(function(){return arguments}())?B:function(t){return I(t)&&Ht.call(t,"callee")&&!Kt.call(t,"callee")},Yt="object"==typeof t&&t&&!t.nodeType&&t,Gt=Yt&&"object"==typeof module&&module&&!module.nodeType&&module,Jt=Gt&&Gt.exports===Yt?lt.Buffer:void 0,Qt=(Jt?Jt.isBuffer:void 0)||function(){return!1},Xt=9007199254740991,te=/^(?:0|[1-9]\d*)$/,ee=9007199254740991,re={};re["[object Float32Array]"]=re["[object Float64Array]"]=re["[object Int8Array]"]=re["[object Int16Array]"]=re["[object Int32Array]"]=re["[object Uint8Array]"]=re["[object Uint8ClampedArray]"]=re["[object Uint16Array]"]=re["[object Uint32Array]"]=!0,re["[object Arguments]"]=re["[object Array]"]=re["[object ArrayBuffer]"]=re["[object Boolean]"]=re["[object DataView]"]=re["[object Date]"]=re["[object Error]"]=re["[object Function]"]=re["[object Map]"]=re["[object Number]"]=re["[object Object]"]=re["[object RegExp]"]=re["[object Set]"]=re["[object String]"]=re["[object WeakMap]"]=!1;var ne="object"==typeof t&&t&&!t.nodeType&&t,ie=ne&&"object"==typeof module&&module&&!module.nodeType&&module,oe=ie&&ie.exports===ne&&ut.process,se=function(){try{return oe&&oe.binding&&oe.binding("util")}catch(t){}}(),ae=se&&se.isTypedArray,ce=ae?function(t){return function(e){return t(e)}}(ae):function(t){return I(t)&&U(t.length)&&!!re[E(t)]},ue=Object.prototype.hasOwnProperty,he=Object.prototype,le=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),fe=Object.prototype.hasOwnProperty,pe=Object.prototype.hasOwnProperty,de=(Object.prototype.propertyIsEnumerable,Object.getOwnPropertySymbols,A(lt,"DataView")),ve=A(lt,"Promise"),ye=A(lt,"Set"),_e=A(lt,"WeakMap"),ge=O(de),be=O(Dt),me=O(ve),Ee=O(ye),je=O(_e),we=E;(de&&"[object DataView]"!=we(new de(new ArrayBuffer(1)))||Dt&&"[object Map]"!=we(new Dt)||ve&&"[object Promise]"!=we(ve.resolve())||ye&&"[object Set]"!=we(new ye)||_e&&"[object WeakMap]"!=we(new _e))&&(we=function(t){var e=E(t),r="[object Object]"==e?t.constructor:void 0,n=r?O(r):"";if(n)switch(n){case ge:return"[object DataView]";case be:return"[object Map]";case me:return"[object Promise]";case Ee:return"[object Set]";case je:return"[object WeakMap]"}return e});Function.prototype.toString.call(Object);var Ce="__lodash_hash_undefined__";Y.prototype.add=Y.prototype.push=function(t){return this.__data__.set(t,Ce),this},Y.prototype.has=function(t){return this.__data__.has(t)};var Oe=ft?ft.prototype:void 0,Re=(Oe&&Oe.valueOf,Object.prototype.hasOwnProperty,Object.prototype.hasOwnProperty,"[object String]"),Te="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ae="(?:\\ud83c[\\udde6-\\uddff]){2}",Le="[\\ud800-\\udbff][\\udc00-\\udfff]",Se="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",ke=(["[^\\ud800-\\udfff]",Ae,Le].join("|"),["[^\\ud800-\\udfff]"+Te+"?",Te,Ae,Le,"[\\ud800-\\udfff]"].join("|"),Math.max),Pe=Ft?function(t,e){return Ft(t,"toString",{configurable:!0,enumerable:!1,value:tt(e),writable:!0})}:J,Me=800,xe=16,De=Date.now,ze=function(t){var e=0,r=0;return function(){var n=De(),i=xe-(n-r);if(r=n,i>0){if(++e>=Me)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Pe),Ne=function(t){return et(function(e,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,s&&rt(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var a=r[n];a&&t(e,a,n,o)}return e})}(function(t,e){z(e,Z(e),t)}),Ie=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Be=function(t){function e(t){nt(this,e);var r=it(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t&&(r.sourceElementSelector=t.sourceElement,r.targetElementSelector=t.targetElement,r.data=t.data,r.standByClass=t.standByClass||st.ClassNames.RECT_STAND_BY,r.activedClass=t.activedClass||st.ClassNames.RECT_ACTIVED,r.selectedClass=t.selectedClass||st.ClassNames.RECT_SELECTED,r.frameSize=t.frameSize,r.startingZIndex=t.startingZIndex||2e3,r.idPropertyName=t.idPropertyName||st.PropertyNames.ID,r.childrenPropertyName=t.childrenPropertyName||st.PropertyNames.childrenPropertyName),r._init(),r}return ot(e,r),Ie(e,[{key:"render",value:function(){this._createMaskLayer(),this._renderRects(this.data)}},{key:"reRender",value:function(){this.clean(),this._init(),this.render()}},{key:"clean",value:function(){for(var t=0;t<this.rects.length;t++)this.rects[t].remove();this.rects=[],this.mask.remove(),this.mask=void 0,this.q=[]}},{key:"_renderRects",value:function(t){if(at(t))for(var e=0;e<t.length;e++)this.q.push(t[e]);else j(t)&&this.q.push(t);for(;this.q.length>0;){var r=this.q.shift();this._createRectOnMaskLayer({rect:r,layerSize:this,frameSize:this.frameSize});var n=r[this.childrenPropertyName];if(n)for(var i=0;i<n.length;i++)this.q.push(n[i])}}},{key:"_createMaskLayer",value:function(){var t=document.createElement("div");t.setAttribute("style","width:100%;height:100%;left:0;right:0;top:0;bottom:0;position:absolute"),t.setAttribute("class",st.ClassNames.MASK),this.container.appendChild(t),this.mask=t,this.layerSize=this.layerSize||{width:this.mask.offsetWidth,height:this.mask.offsetHeight}}},{key:"_init",value:function(){this.sourceElement=document.querySelector(this.sourceElementSelector),this.targetElement=document.querySelector(this.targetElementSelector),this.targetElement?this.container=this.targetElement:this.container=this.sourceElement.parentElement,this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.rects=[],this.selectedRect={},this.selectedRealRect={},this.q=[],this.rectsMap={}}},{key:"_createRectOnMaskLayer",value:function(t){var e=this,r=void 0,n=void 0,i=void 0;t&&(r=t.rect||{left:0,top:0,right:0,bottom:0},n=t.layerSize||{width:100,height:100},i=t.frameSize||{width:100,height:100});var o=r;(o=Ne({},r)).left=void 0==r.left?void 0:r.left*n.width/i.width,o.right=void 0==r.right?void 0:r.right*n.width/i.width,o.top=void 0==r.top?void 0:r.top*n.height/i.height,o.bottom=void 0==r.bottom?void 0:r.bottom*n.height/i.height,o.width=void 0==r.width?void 0:r.width*n.width/i.width,o.height=void 0==r.height?void 0:r.height*n.height/i.height;var s=document.createElement("div"),a="position:absolute;";void 0!=o.left&&(a+="left:"+o.left+"px;"),void 0!=o.right&&(a+="right:"+o.right+"px;"),void 0!=o.top&&(a+="top:"+o.top+"px;"),void 0!=o.bottom&&(a+="bottom:"+o.bottom+"px;"),void 0!=o.width&&(a+="width:"+o.width+"px;"),void 0!=o.height&&(a+="height:"+o.height+"px;"),a+="box-sizing: border-box;z-index: "+this.startingZIndex++,s.setAttribute("style",a),s.setAttribute("class",this.standByClass),s.addEventListener("mouseover",function(){e._highlight(s,o)}),s.addEventListener("mouseout",function(){e._unhighlight(s,o)}),s.addEventListener("click",function(){e.selectedRect==s?e._unselect(e.selectedRect,e.selectedRealRect):(e._unselect(e.selectedRect,e.selectedRealRect),e._select(s,o))}),this.container.appendChild(s),this.rects.push(s);var c=o[this.idPropertyName];G(c)&&(this.rectsMap[c]={el:s,data:o})}},{key:"select",value:function(t,e){G(t)&&j(this.rectsMap[t])&&this._select(this.rectsMap[t].el,this.rectsMap[t].data,e)}},{key:"unselect",value:function(t,e){G(t)&&j(this.rectsMap[t])&&this._unselect(this.rectsMap[t].el,this.rectsMap[t].data,e)}},{key:"_select",value:function(t,e,r){this.selectedRect!=t&&(this.selectedRect=t,this.selectedRealRect=e,t.setAttribute("class",this.selectedClass),r||this.emit(st.Events.RECT_SELECTED,e))}},{key:"_unselect",value:function(t,e,r){this.selectedRect==t&&w(this.selectedRect.setAttribute)&&(this.selectedRect.setAttribute("class",this.standByClass),r||this.emit(st.Events.RECT_UNSELECTED,this.selectedRealRect),this.selectedRealRect={},this.selectedRect={})}},{key:"highlight",value:function(t,e){G(t)&&j(this.rectsMap[t])&&this._highlight(this.rectsMap[t].el,this.rectsMap[t].data,e)}},{key:"unhighlight",value:function(t,e){G(t)&&j(this.rectsMap[t])&&this._unhighlight(this.rectsMap[t].el,this.rectsMap[t].data,e)}},{key:"_highlight",value:function(t,e,r){this.selectedRect!=t&&t.setAttribute("class",this.activedClass),r||this.emit(st.Events.RECT_ACTIVED,e)}},{key:"_unhighlight",value:function(t,e,r){this.selectedRect!=t&&t.setAttribute("class",this.standByClass),r||this.emit(st.Events.RECT_DISACTIVED,e)}}]),e}();t.CanvasHighlighter=Be})(this["canvas-highlighter"]=this["canvas-highlighter"]||{});